/* styles/main.css v1.0.2
   Главная (Today): тема 60-30-10, светлая/тёмная, таймлайн, дни, FAB, шторка, онбординг, фокус-таймер. */

/* =========================
   THEME TOKENS (правило 60-30-10)
   ========================= */
:root{
  --accent:#3B77FF;             /* 10% — CTA/акцент («металлический» синий) */
  --accent-weak:#E8F0FF;

  /* LIGHT (60% фон, 30% текст/поверхности) */
  --bg:#F7F8FB;                 /* основной фон (60) */
  --surface:#FFFFFF;            /* карточки/панели */
  --surface-2:#F1F3F7;          /* вторичная поверхность */
  --text:#0E1116;               /* заголовки/основной (30) */
  --muted:#6B7280;              /* подписи/вторичка */
  --line:#E6EAF0;

  --r-xl:28px; --r-lg:20px; --r-md:14px; --r-sm:10px;
  --shadow:0 16px 40px rgba(15,18,22,.08);
  --shadow-strong:0 20px 50px rgba(15,18,22,.12);
  --ui-speed:.25s cubic-bezier(.2,.8,.2,1);
}
@media (prefers-color-scheme:dark){
  :root{
    --bg:#0E1114;
    --surface:#161A1F;
    --surface-2:#1B2026;
    --text:#F3F5F7;
    --muted:#98A1AE;
    --line:#262C34;
    --accent-weak:#223B82;
  }
}

/* ===== base ===== */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font:15px/1.45 Inter,system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans",sans-serif;
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
  -webkit-tap-highlight-color:transparent;
}
.sr-only{position:absolute !important;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}

body,.app,.panel,.nav,.tab,.fab,.sheet,.day,.item,.input,select,.badge,.chip{
  transition:background-color var(--ui-speed),color var(--ui-speed),border-color var(--ui-speed),box-shadow var(--ui-speed),outline-color var(--ui-speed);
}

.app{max-width:520px;margin:0 auto;min-height:100dvh;display:flex;flex-direction:column;padding-bottom:120px}

/* ===== APP BAR ===== */
.appbar{height:64px;display:flex;align-items:center;justify-content:space-between;padding:0 16px}
.appbar .title{font-weight:800;letter-spacing:.2px}
.icon{
  width:40px;height:40px;border-radius:14px;display:grid;place-items:center;
  background:var(--surface-2);border:1px solid var(--line);
}

/* ===== MONTH / DAY STRIP ===== */
.section{padding:0 16px}
.month{display:flex;align-items:center;justify-content:center;gap:10px;margin:4px 0 6px;color:var(--muted)}
.month b{color:var(--text)}
.nav-arrow{border:none;background:transparent;color:var(--muted);font-size:18px;padding:6px 8px;border-radius:10px}
.nav-arrow:active{background:var(--surface-2)}

.days{display:flex;gap:12px;overflow:auto;padding:6px 2px 14px;scroll-snap-type:x mandatory}
.day{
  min-width:78px;background:var(--surface);border:1px solid var(--line);
  border-radius:24px;padding:10px 10px;text-align:center;scroll-snap-align:start;position:relative;
  box-shadow:var(--shadow);
}
.day .dow{font-size:12px;color:var(--muted);margin-bottom:4px}
.day .date{font-size:22px;font-weight:800}
.day .mon{font-size:11px;color:var(--muted)}
.day.today::after{
  content:"сегодня";position:absolute;right:8px;top:-9px;
  font-size:10px;background:var(--accent);color:white;border-radius:999px;padding:2px 8px;box-shadow:var(--shadow);
}
.day.selected{outline:2px solid var(--accent);outline-offset:2px}

/* ===== TIMELINE LIST ===== */
.panel{
  margin-top:8px;background:transparent;border-radius:28px 28px 0 0;
  padding:4px 0 0;
}
.timeline{position:relative;padding:0 16px}
/* сдвинул линию левее, чтобы не лезла на колонку времени */
.timeline::before{
  content:"";position:absolute;left:24px;top:0;bottom:24px;width:2px;background:var(--line);
}
.item{
  display:grid;grid-template-columns:96px 1fr auto; /* шире колонка времени */
  gap:14px;align-items:flex-start;
  padding:14px 12px;margin:10px 0;background:var(--surface);
  border:1px solid var(--line);border-radius:20px;box-shadow:var(--shadow);
}
.item.big{background:linear-gradient(0deg,var(--accent-weak),var(--accent-weak));border-color:transparent;box-shadow:var(--shadow-strong)}
.time{width:96px;text-align:right;padding-right:10px;font-weight:700;color:var(--text);position:relative;z-index:2}
.dot{
  position:absolute;left:20px; /* левее колонки времени */
  width:10px;height:10px;border-radius:999px;background:var(--accent);
  transform:translateY(18px);box-shadow:0 0 0 4px rgba(59,119,255,.18);
  z-index:1;pointer-events:none;
}
.titleRow{display:flex;align-items:center;gap:8px;flex-wrap:wrap}
.title{font-weight:800}
.badge{font-size:11px;border-radius:999px;padding:4px 8px;background:var(--surface-2);border:1px solid var(--line);color:var(--muted)}
.badge.ok{background:rgba(59,119,255,.12);color:var(--text)}
.meta{font-size:12px;color:var(--muted);margin-top:4px}
.actions{display:flex;gap:8px}
.icon-btn{
  width:36px;height:36px;border-radius:12px;border:1px solid var(--line);background:var(--surface-2);display:grid;place-items:center
}

/* выполненные — прозрачнее */
.item.done{opacity:.4}

/* ===== NAV ===== */
.nav{
  position:fixed;left:50%;bottom:16px;transform:translateX(-50%);
  display:flex;gap:10px;background:var(--surface);border:1px solid var(--line);
  border-radius:999px;padding:8px 12px;box-shadow:var(--shadow-strong);z-index:5;
  padding-bottom:calc(8px + env(safe-area-inset-bottom,0px));
}
.tab{width:46px;height:46px;border-radius:14px;border:1px solid var(--line);background:var(--surface-2);display:grid;place-items:center}
.tab.active{background:var(--accent);color:white;border-color:transparent}

/* ===== FAB ===== */
.fab{
  position:fixed;left:50%;bottom:96px;transform:translateX(-50%);
  width:72px;height:72px;border-radius:22px;border:none;background:var(--accent);color:#fff;font-size:36px;
  display:grid;place-items:center;box-shadow:0 24px 56px rgba(0,0,0,.3);z-index:4
}
@keyframes fab-bounce{0%{transform:translateX(-50%) scale(1)}40%{transform:translateX(-50%) scale(.94)}100%{transform:translateX(-50%) scale(1)}}
.fab.bounce{animation:fab-bounce .18s}

/* ===== SHEET (Add) ===== */
.backdrop{position:fixed;inset:0;background:rgba(0,0,0,.45);opacity:0;pointer-events:none;transition:.25s}
.sheet{
  position:fixed;left:0;right:0;bottom:0; /* было bottom:-100% — из-за этого её не было видно */
  max-width:520px;margin:0 auto;background:var(--surface);
  border-top-left-radius:26px;border-top-right-radius:26px;border:1px solid var(--line);
  box-shadow:0 -24px 64px rgba(0,0,0,.35);
  transform:translateY(100%); /* скрыта за пределами экрана */
  will-change:transform;
  transition:.38s cubic-bezier(.18,.88,.22,1.05);z-index:6
}
.backdrop.open{opacity:1;pointer-events:auto}
.sheet.open{transform:translateY(0)}
.handle{width:64px;height:6px;border-radius:999px;background:var(--line);margin:10px auto 6px}
.body{padding:14px 16px 18px}
.field{margin:12px 0}
.label{font-size:12px;color:var(--muted);margin-bottom:6px}
.input,select{width:100%;padding:12px;border:1px solid var(--line);border-radius:14px;background:var(--surface-2);color:var(--text)}
.seg{display:flex;border:1px solid var(--line);border-radius:14px;overflow:hidden}
.seg button{flex:1;padding:10px;border:none;background:var(--surface-2);color:var(--text)}
.seg button[aria-pressed="true"]{background:var(--accent);color:#fff}
.chips{display:flex;gap:8px;flex-wrap:wrap}
.chip{padding:9px 11px;border:1px solid var(--line);border-radius:999px;background:var(--surface-2)}
.chip[aria-pressed="true"]{background:#111;color:#fff;border-color:#111}
.row{display:flex;gap:10px}
.grow{flex:1}
.footer{display:flex;gap:10px;margin-top:10px}
.btn{flex:1;padding:12px;border-radius:14px;border:1px solid var(--line);background:var(--surface-2);color:var(--text)}
.btn.primary{background:var(--accent);color:#fff;border-color:transparent}
.hint{margin-top:6px;font-size:12px;color:var(--muted)}

/* ===== ONBOARDING ===== */
.ob-wrap{position:fixed;inset:0;background:rgba(0,0,0,.55);display:none;z-index:9}
.ob-wrap[hidden]{display:none}
.ob-card{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:min(520px,92vw);
  background:var(--surface);border:1px solid var(--line);border-radius:24px;box-shadow:var(--shadow-strong);padding:20px}
.ob-h{font-weight:800;font-size:20px;margin-bottom:8px}
.ob-p{color:var(--muted);margin:6px 0}
.ob-dots{display:flex;gap:6px;justify-content:center;margin-top:8px}
.ob-dot{width:8px;height:8px;border-radius:999px;background:var(--line)}
.ob-dot.active{background:var(--accent)}
.ob-btm{display:flex;gap:10px;margin-top:14px}
.ob-btn{flex:1;padding:12px;border-radius:14px;border:1px solid var(--line);background:var(--surface-2);color:var(--text)}
.ob-btn.primary{background:var(--accent);color:#fff;border-color:transparent}

/* ===== FOCUS TIMER ===== */
.ft-wrap{position:fixed;inset:0;display:none;background:rgba(0,0,0,.6);z-index:8}
.ft-wrap[hidden]{display:none}
.ft-card{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:min(520px,92vw);height:56vh;
  background:var(--surface);border:1px solid var(--line);border-radius:24px;box-shadow:var(--shadow-strong);display:flex;flex-direction:column}
.ft-top{display:flex;justify-content:space-between;align-items:center;padding:12px 16px}
.ft-canvas{flex:1;border-top:1px solid var(--line);border-bottom:1px solid var(--line);display:grid;place-items:center}
.ft-btm{padding:12px 16px;display:flex;gap:10px}
.ft-btn{flex:1;padding:12px;border-radius:14px;border:1px solid var(--line);background:var(--surface-2);color:var(--text)}
.ft-btn.primary{background:var(--accent);color:#fff;border-color:transparent}

/* ===== Canvas confetti ===== */
#confettiCanvas{position:fixed;inset:0;pointer-events:none;z-index:7}
