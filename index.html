<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Weepl v3 — Сегодня</title>

  <!-- iOS PWA: убираем чёрную полосу, растягиваем фон под статус-бар -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Sora:wght@500;600;700&display=swap" rel="stylesheet">

  <!-- Основные стили -->
  <link rel="stylesheet" href="styles.css">

  <!-- Небольшие доп.правки для липкой шапки -->
  <style>
    /* липкая шапка с блюром и безопасной зоной для вырезов */
    header{
      position: sticky;
      top: env(safe-area-inset-top);
      z-index: 20;
      padding-top: calc(20px + env(safe-area-inset-top)) !important;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      background: color-mix(in oklab, var(--panel) 85%, transparent 15%);
      border-bottom: 1px solid color-mix(in oklab, var(--ink) 8%, transparent);
      border-top-left-radius: 16px;
      border-top-right-radius: 16px;
    }
    /* чтобы контент не уезжал под шапку при самом первом экране */
    main{ scroll-margin-top: calc(56px + env(safe-area-inset-top)); }
  </style>
</head>

<body data-theme="light">
  <!-- Фон -->
  <div class="bg"></div>
  <div class="bg-veil"></div>
  <div class="noise"></div>

  <div class="wrap">
    <header>
      <div class="title">
        <h1>Сегодня</h1>
        <div class="date">Вторник, 4 ноября</div>
      </div>

      <div class="controls">
        <button class="icon-btn" id="themeToggle" aria-label="Переключить тему">
          <svg id="sunIcon" viewBox="0 0 24 24" fill="none" stroke-width="1.8">
            <circle cx="12" cy="12" r="4"></circle>
            <path d="M12 2v2M12 20v2M4 12H2M22 12h-2M5 5l-1.5-1.5M19 19l1.5 1.5M19 5l1.5-1.5M5 19L3.5 20.5"></path>
          </svg>
          <svg id="moonIcon" viewBox="0 0 24 24" fill="none" stroke-width="1.8" style="display:none">
            <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
          </svg>
        </button>
      </div>
    </header>

    <main>
      <!-- AI TIP -->
      <div class="ai-tip" id="aiTip" title="Нажми, чтобы обновить совет">
        <span class="ai-dot"></span>
        <span id="aiText">Загружаю совет…</span>
        <span class="ai-refresh" aria-hidden="true">
          <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
            <path d="M20 11a8 8 0 1 1-2.34-5.66M20 4v7h-7"></path>
          </svg>
        </span>
      </div>

      <!-- GRID -->
      <section class="grid">
        <div class="grid-inner" aria-label="Задачи на сегодня">
          <article class="card wide" tabindex="0">
            <div>
              <h3>Разработка интерфейса</h3>
              <p>UI прототип Weepl v3 — главная страница и навигация</p>
            </div>
            <div class="meta"><span>Проект: Weepl</span><span>09:00</span></div>
          </article>

          <article class="card square" tabindex="0">
            <div>
              <h3>Кофе и планирование</h3>
              <p>10 минут тишины, ревью задач</p>
            </div>
            <div class="meta"><span>Фокус</span><span>11:00</span></div>
          </article>

          <article class="card tall" tabindex="0">
            <div>
              <h3>Митинг с Артёмом</h3>
              <p>Дизайн-сессия: анимации и микроинтеракции</p>
            </div>
            <div class="meta"><span>Созвон</span><span>13:30</span></div>
          </article>

          <article class="card square" tabindex="0">
            <div>
              <h3>Прогулка / перезагрузка</h3>
              <p>Короткий спринт восстановления</p>
            </div>
            <div class="meta"><span>Здоровье</span><span>15:10</span></div>
          </article>

          <article class="card wide" tabindex="0">
            <div>
              <h3>Архив → разбор</h3>
              <p>Ретроспектива: что отдать в «завтра», а что закрыть сегодня</p>
            </div>
            <div class="meta"><span>Подведение итогов</span><span>17:00</span></div>
          </article>
        </div>
      </section>
    </main>
  </div>

  <nav>
    <div class="dock wrap" role="tablist" aria-label="Основная навигация">
      <button class="active" role="tab" aria-selected="true">
        <svg viewBox="0 0 24 24" fill="none" stroke-width="2"><path d="M3 10.5l9-7 9 7V21a1 1 0 0 1-1 1h-5v-6H9v6H4a1 1 0 0 1-1-1V10.5z"/></svg>
        Сегодня
      </button>
      <button role="tab">
        <svg viewBox="0 0 24 24" fill="none" stroke-width="2"><rect x="3" y="4" width="18" height="16" rx="2"/><path d="M7 8h10M7 12h6M7 16h5"/></svg>
        Архив
      </button>
      <button role="tab">
        <svg viewBox="0 0 24 24" fill="none" stroke-width="2"><path d="M3 17s3-6 9-6 9 6 9 6"/><circle cx="12" cy="11" r="2"/></svg>
        Аналитика
      </button>
      <button role="tab">
        <svg viewBox="0 0 24 24" fill="none" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 1 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 5 15.4a1.65 1.65 0 0 0-1.51-1H3a2 2 0 1 1 0-4h.09a1.65 1.65 0 0 0 1.51-1 1.65 1.65 0 0 0-.33-1.82l-.06-.06A2 2 0 1 1 7.04 3.7l.06.06A1.65 1.65 0 0 0 8.6 4.1h.01A1.65 1.65 0 0 0 10.1 3H10a2 2 0 1 1 4 0v.09c.46.17.86.49 1.11.92.25.43.33.93.24 1.41"/></svg>
        Настройки
      </button>
    </div>
  </nav>

  <script>
    // ТЕМА
    const body = document.body;
    const toggle = document.getElementById('themeToggle');
    const sun = document.getElementById('sunIcon');
    const moon = document.getElementById('moonIcon');
    function setTheme(t){
      body.dataset.theme = t;
      const isDark = t === 'dark';
      sun.style.display = isDark ? 'none' : 'block';
      moon.style.display = isDark ? 'block' : 'none';
      localStorage.setItem('weepl-theme', t);
    }
    setTheme(localStorage.getItem('weepl-theme') || 'light');
    toggle.addEventListener('click', ()=> setTheme(body.dataset.theme === 'light' ? 'dark' : 'light'));

    // AI СОВЕТЫ (как в прошлой версии)
    const tips = [
      'Заверши энергозатратные задачи до обеда — окно фокуса выше на 18–25%.',
      'Планируй «глубокую работу» блоками по 50–90 минут, между ними — 10–15 минут разгрузки.',
      'Спроси себя «что сдвинет проект сильнее всего?» и сделай это первым.',
      'Отключи уведомления на 45 минут — вероятность прерываний падает вдвое.',
      'Запиши 3 задачи дня. Остальное — в бэклог. Чёткие границы уменьшают прокрастинацию.',
      'Сложное разбей на микрошаги по 5–10 минут — стартовать всегда легче.',
      'Подготовь завтра сегодня: 5 минут вечером экономят 20 утром.',
      'Планируй созвоны во второй половине дня — у утреннего мозга выше креативность.',
      'Оцени «стоимость контекста»: сгруппируй похожие задачи в один слот.',
      'Выбери «анти-задачу»: что НЕ делать сегодня, чтобы сохранить фокус.'
    ];
    const aiText = document.getElementById('aiText');
    const aiTip = document.getElementById('aiTip');
    function seedIndex(){
      const saved = localStorage.getItem('weepl-tip-index');
      if(saved !== null) return parseInt(saved,10);
      const d = new Date();
      const key = d.getFullYear()*10000 + (d.getMonth()+1)*100 + d.getDate();
      return key % tips.length;
    }
    let tipIndex = seedIndex();
    function renderTip(){
      aiText.textContent = 'AI-совет: ' + tips[tipIndex];
      localStorage.setItem('weepl-tip-index', tipIndex.toString());
    }
    renderTip();
    aiTip.addEventListener('click', ()=>{
      tipIndex = (tipIndex + 1) % tips.length;
      aiTip.style.opacity = .85;
      setTimeout(()=>{ aiTip.style.opacity = 1; }, 160);
      renderTip();
    });
  </script>
</body>
</html>
