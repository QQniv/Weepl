<!doctype html>
<html lang="ru" class="no-js">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Weepl • Планировщик</title>

  <!-- Шрифты (Impact-стиль для заголовков + нейтральный текстовый) -->
  <link href="https://fonts.googleapis.com/css2?family=Anton&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Стили -->
  <link rel="stylesheet" href="./styles.css"/>

  <!-- PWA meta (опционально, не мешает) -->
  <meta name="theme-color" content="#ffffff"/>
</head>
<body>

  <!-- ====== TOPBAR: заголовок месяца на главной и в календаре ====== -->
  <header class="topbar">
    <button id="navPrev" class="iconbtn" aria-label="Предыдущий месяц">←</button>
    <h1 id="topTitle" class="month-title">Октябрь 2025 г.</h1>
    <button id="navNext" class="iconbtn" aria-label="Следующий месяц">→</button>
  </header>

  <!-- ====== ОСНОВНОЕ ПОЛЕ ПРИЛОЖЕНИЯ ====== -->
  <main id="viewContainer" class="view">

    <!-- ====== TODAY VIEW (главная) ====== -->
    <section id="todayView" class="screen screen--active" role="region" aria-label="Сегодня">

      <!-- Горизонтальный скроллер дат (пилюли). По центру всегда сегодня -->
      <div class="date-strip">
        <div id="dateScroller" class="date-strip__scroller" aria-label="Выбор даты">
          <!-- JS вставит карточки-дни -->
        </div>
      </div>

      <!-- Блок “Сегодня” с двумя секциями: линейка событий (временной промежуток) и список задач -->
      <div class="today-panels">

        <!-- Тайм-лента событий (08:00–20:00). Внутрь позиционируются блоки событий. -->
        <section class="panel" aria-label="События за день">
          <div class="panel__head">
            <h2 class="panel__title">События</h2>
            <div class="panel__hint">длительные блоки по времени</div>
          </div>

          <div id="timeline" class="timeline" aria-live="polite" aria-relevant="additions">
            <!-- JS: рендер шкалы часов + события с высотой по длительности -->
          </div>
        </section>

        <!-- Список задач (фиксированные карточки) -->
        <section class="panel" aria-label="Задачи за день">
          <div class="panel__head">
            <h2 class="panel__title">Задачи</h2>
            <div id="kpiCounter" class="panel__hint">Задач: 0</div>
          </div>

          <ul id="taskList" class="tasklist" aria-live="polite" aria-relevant="additions removals">
            <!-- JS: задачи. Свайп вправо — выполнить; влево — меню переноса -->
          </ul>
        </section>

      </div>
    </section>

    <!-- ====== CALENDAR VIEW (полноэкранная сетка, без верхнего барабана дат) ====== -->
    <section id="calendarView" class="screen" role="region" aria-label="Календарь">
      <div class="calendar-head">
        <button id="calPrev" class="iconbtn" aria-label="Предыдущий месяц">←</button>
        <h2 id="calTitle" class="month-title">Октябрь 2025 г.</h2>
        <button id="calNext" class="iconbtn" aria-label="Следующий месяц">→</button>
      </div>

      <div class="calendar">
        <div class="calendar__wd">Пн</div><div class="calendar__wd">Вт</div><div class="calendar__wd">Ср</div>
        <div class="calendar__wd">Чт</div><div class="calendar__wd">Пт</div><div class="calendar__wd">Сб</div><div class="calendar__wd">Вс</div>
        <div id="calendarGrid" class="calendar__grid" aria-label="Сетка дней">
          <!-- JS: 6×7 ячеек, полностью помещается на экране -->
        </div>
      </div>

      <p class="calendar-hint">Выберите день, чтобы увидеть задачи и события.</p>
    </section>

    <!-- ====== STATS VIEW ====== -->
    <section id="statsView" class="screen" role="region" aria-label="Статистика">
      <h2 class="screen-title">Статистика</h2>
      <div class="stats-grid">
        <div class="stat-card">
          <div class="ring" aria-label="Процент выполнения за неделю">
            <svg viewBox="0 0 120 120" class="ring__svg" aria-hidden="true">
              <circle cx="60" cy="60" r="52" class="ring__bg"></circle>
              <circle cx="60" cy="60" r="52" class="ring__fg" id="ringFg"></circle>
            </svg>
            <div id="ringPct" class="ring__label">0%</div>
          </div>
          <div class="stat-card__caption">Выполнено за неделю</div>
        </div>

        <div class="stat-card">
          <div class="stat-card__big" id="w7Stat">0 / 0</div>
          <div class="stat-card__caption">За 7 дней</div>
        </div>

        <div class="stat-card">
          <div class="stat-card__big" id="monthStat">0 / 0</div>
          <div class="stat-card__caption">За месяц</div>
        </div>

        <div class="stat-card">
          <div class="stat-card__big" id="streakStat">0</div>
          <div class="stat-card__caption">Серия выполнений</div>
        </div>

        <div class="stat-wide">
          <div class="stat-wide__head">
            <div class="stat-wide__title">Выполнено по дням</div>
            <div class="stat-wide__hint">последние 7 дней</div>
          </div>
          <canvas id="bar7" width="700" height="180" aria-label="Столбцы за 7 дней"></canvas>
        </div>
      </div>
    </section>

    <!-- ====== SETTINGS VIEW ====== -->
    <section id="settingsView" class="screen" role="region" aria-label="Настройки">
      <h2 class="screen-title">Настройки</h2>

      <div class="settings">
        <div class="setting-row">
          <div class="setting-row__label">Акцентный цвет</div>
          <div class="setting-row__ctrl">
            <input id="accentPicker" type="color" value="#6a5bff" />
          </div>
        </div>

        <div class="setting-row">
          <div class="setting-row__label">Неон-эффект</div>
          <div class="setting-row__ctrl">
            <label class="switch">
              <input id="toggleNeon" type="checkbox"/>
              <span class="switch__bar"></span>
            </label>
          </div>
        </div>

        <div class="setting-row">
          <div class="setting-row__label">Металличность</div>
          <div class="setting-row__ctrl">
            <label class="switch">
              <input id="toggleMetal" type="checkbox"/>
              <span class="switch__bar"></span>
            </label>
          </div>
        </div>

        <div class="setting-row">
          <div class="setting-row__label">Размер текста</div>
          <div class="setting-row__ctrl">
            <input id="fontScale" type="range" min="90" max="115" step="5" value="100"/>
          </div>
        </div>
      </div>
    </section>

  </main>

  <!-- ====== FAB (добавить) ====== -->
  <button id="fabAdd" class="fab" aria-label="Добавить">+</button>

  <!-- ====== НИЖНЯЯ НАВИГАЦИЯ ====== -->
  <nav class="tabbar" aria-label="Навигация по разделам">
    <button id="tabTasks"    class="tabbar__btn" aria-label="Задачи"   data-view="today"><span class="i i-list"></span></button>
    <button id="tabCalendar" class="tabbar__btn" aria-label="Календарь" data-view="calendar"><span class="i i-cal"></span></button>
    <button id="tabStats"    class="tabbar__btn" aria-label="Статистика" data-view="stats"><span class="i i-bars"></span></button>
    <button id="tabSettings" class="tabbar__btn" aria-label="Настройки" data-view="settings"><span class="i i-gear"></span></button>
  </nav>

  <!-- Модалка переноса дедлайна (исправлен баг “Отмена скрывает задачу”) -->
  <dialog id="rescheduleDlg" class="dlg">
    <form method="dialog" class="dlg__card" id="rescheduleForm">
      <div class="dlg__title">Перенести</div>
      <div class="dlg__grid">
        <button value="b15" class="chip">+15 мин</button>
        <button value="b30" class="chip">+30 мин</button>
        <button value="h1"  class="chip">+1 час</button>
        <button value="d1"  class="chip">+1 день</button>
      </div>
      <div class="dlg__custom">
        <label class="dlg__label">Минуты</label>
        <input id="resMins" type="number" min="1" max="1440" step="1" placeholder="Минуты" class="dlg__input"/>
        <button value="apply" class="btn btn--primary">Применить</button>
      </div>
      <div class="dlg__actions">
        <button value="cancel" class="btn">Отмена</button>
      </div>
    </form>
  </dialog>

  <!-- Скрипт приложения -->
  <script src="./app.js" defer></script>
</body>
</html>
