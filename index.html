<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#0f1115" media="(prefers-color-scheme: dark)">
  <title>Weepl • Планировщик будущего</title>

  <!-- редирект в /Weepl/ если открыли корень профиля -->
  <script>
    (function(){
      var need = '/Weepl/';
      if (location.hostname.endsWith('github.io') && location.pathname === '/') {
        location.replace(need);
      }
    })();
  </script>
  <!-- dynamic <base> для относительных путей -->
  <script>
    (function(){
      var basePath = location.pathname.replace(/[^/]*$/, '');
      document.write('<base href="'+ basePath +'">');
    })();
  </script>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Anton&family=Manrope:wght@400;600;700;800&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="styles.css?v=2500">
  <script defer src="app.js?v=2500"></script>
</head>
<body>
  <div id="app"></div>

  <!-- ====== LAYOUT ====== -->
  <template id="layout">
    <main id="view" class="section"></main>

    <!-- Floating Action Button — по центру снизу -->
    <button id="fabAdd" class="fab" aria-label="Добавить задачу">+</button>

    <!-- Bottom Navigation -->
    <nav class="bottombar" role="navigation" aria-label="Главная навигация">
      <a class="navbtn active" data-route="#/" href="#/" aria-label="Задачи" title="Задачи">
        <!-- tasks icon -->
        <svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true">
          <path fill="currentColor" d="M9 3h6a2 2 0 0 1 2 2h1a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h1a2 2 0 0 1 2-2Zm0 2a1 1 0 0 0-1 1H6v12h12V6h-2a1 1 0 0 0-1-1H9Zm1 6h6v2h-6v-2Zm0 4h6v2h-6v-2Zm-2-4H6v2h2v-2Zm0 4H6v2h2v-2Z"/>
        </svg>
      </a>

      <a class="navbtn" data-route="#/calendar" href="#/calendar" aria-label="Календарь" title="Календарь">
        <!-- calendar icon -->
        <svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true">
          <path fill="currentColor" d="M7 2h2v2h6V2h2v2h2a2 2 0 0 1 2 2v3H3V6a2 2 0 0 1 2-2h2V2Zm14 7v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V9h18Zm-11 3H6v3h4v-3Z"/>
        </svg>
      </a>

      <!-- центрический FAB остаётся отдельно -->

      <a class="navbtn" data-route="#/stats" href="#/stats" aria-label="Статистика" title="Статистика">
        <!-- stats icon -->
        <svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true">
          <path fill="currentColor" d="M4 21a1 1 0 0 1-1-1V4h2v15h15v2H4Zm4-4V9h3v8H8Zm5 0V5h3v12h-3Z"/>
        </svg>
      </a>

      <a class="navbtn" data-route="#/settings" href="#/settings" aria-label="Настройки" title="Настройки">
        <!-- gear icon -->
        <svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true">
          <path fill="currentColor" d="M12 8a4 4 0 1 1 0 8 4 4 0 0 1 0-8Zm8.94 3.34 1.56.9-1 1.73-1.78-.32a7.97 7.97 0 0 1-1.03 1.79l.57 1.71-1.86 1.08-1.25-1.29a7.9 7.9 0 0 1-2.06.6L13.5 20h-3l-.53-1.46a7.9 7.9 0 0 1-2.06-.6L6.16 19.2 4.3 18.12l.57-1.71a8.05 8.05 0 0 1-1.03-1.79l-1.78.32-1-1.73 1.56-.9a8.2 8.2 0 0 1 0-2.68l-1.56-.9 1-1.73 1.78.32c.28-.64.63-1.24 1.03-1.79L4.3 3.88 6.16 2.8l1.25 1.29c.65-.28 1.34-.48 2.06-.6L10.5 2h3l.53 1.46c.72.12 1.41.32 2.06.6L17.34 2.8 19.2 3.88l-.57 1.71c.4.55.75 1.15 1.03 1.79l1.78-.32 1 1.73-1.56.9c.09.44.12.89.12 1.34s-.03.9-.12 1.34Z"/>
        </svg>
      </a>
    </nav>
  </template>

  <!-- ====== HOME VIEW ====== -->
  <template id="home-view">
    <section class="home">
      <div class="month-bar">
        <button class="month-btn" data-home-month="prev" aria-label="Предыдущий месяц">←</button>
        <h2 id="homeMonth" class="h-impact"></h2>
        <button class="month-btn" data-home-month="next" aria-label="Следующий месяц">→</button>
      </div>
      <div id="dateStrip" class="date-strip"></div>
      <h3 id="todayTitle" class="h-sub"></h3>
      <div id="taskList" class="task-list"></div>
    </section>
  </template>

  <!-- ====== CALENDAR VIEW ====== -->
  <template id="calendar-view">
    <section>
      <div class="calendar-head">
        <button class="month-btn" data-cal="prev" aria-label="Предыдущий месяц">←</button>
        <h2 id="calTitle" class="h-impact"></h2>
        <div class="head-actions">
          <button class="chip" id="btnToday">Сегодня</button>
        </div>
        <button class="month-btn" data-cal="next" aria-label="Следующий месяц">→</button>
      </div>

      <div id="calendarGrid" class="calendar-grid"></div>

      <div class="legend">
        <span><i class="lg lg-low"></i> Низкий</span>
        <span><i class="lg lg-med"></i> Средний</span>
        <span><i class="lg lg-high"></i> Высокий</span>
        <span><i class="lg lg-crit"></i> Критический</span>
      </div>

      <div id="calendarTasks" class="calendar-tasks"></div>
    </section>
  </template>

  <!-- ====== STATS VIEW ====== -->
  <template id="stats-view">
    <section class="stats">
      <h2 class="h-impact" style="margin:8px 0 14px">Статистика</h2>

      <div class="stats-grid">
        <!-- прогресс-ринг -->
        <div class="card center">
          <div class="ring">
            <svg viewBox="0 0 120 120" class="ring-svg" aria-hidden="true">
              <circle cx="60" cy="60" r="52" class="ring-bg"/>
              <circle cx="60" cy="60" r="52" class="ring-fg" id="ringFg"/>
            </svg>
            <div class="ring-val"><span id="statDonePct">0</span>%</div>
          </div>
          <div class="muted">Выполнено за неделю</div>
        </div>

        <!-- счётчики -->
        <div class="card">
          <div class="kpi"><span id="statWeekDone">0</span><small> / <span id="statWeekTotal">0</span></small></div>
          <div class="muted">Задач за 7 дней</div>
        </div>

        <div class="card">
          <div class="kpi"><span id="statMonthDone">0</span><small> / <span id="statMonthTotal">0</span></small></div>
          <div class="muted">Задач за месяц</div>
        </div>

        <div class="card">
          <div class="kpi"><span id="statStreak">0</span><small> дн.</small></div>
          <div class="muted">Серия выполнения</div>
        </div>
      </div>

      <!-- мини-график по дням недели -->
      <div class="card barcard">
        <div class="bar-head">
          <div class="h-sub" style="margin:0">Выполнено по дням</div>
          <div class="muted" id="barRange">последние 7 дней</div>
        </div>
        <div class="bars" id="bars"></div>
        <div class="bar-labels" id="barLabels"></div>
      </div>
    </section>
  </template>

  <!-- ====== SETTINGS VIEW ====== -->
  <template id="settings-view">
    <section>
      <div class="settings-section">
        <div class="section-title">Внешний вид</div>
        <div class="settings-list">
          <div class="row item">
            <div class="left">
              <div class="label">Тема</div>
              <div class="sub">Светлая или тёмная</div>
            </div>
            <div class="right">
              <select id="setTheme">
                <option value="light">Светлая</option>
                <option value="dark">Тёмная</option>
              </select>
            </div>
          </div>

          <div class="row item">
            <div class="left">
              <div class="label">Акцентный цвет</div>
              <div class="sub">10 современных оттенков</div>
            </div>
            <div class="right">
              <select id="setAccent">
                <option value="blue">Синий</option>
                <option value="rose">Розовый</option>
                <option value="violet">Фиолетовый</option>
                <option value="mint">Мятный</option>
                <option value="lemon">Жёлтый</option>
                <option value="coral">Коралловый</option>
                <option value="azure">Голубой</option>
                <option value="orchid">Орхидея</option>
                <option value="sky">Небесный</option>
                <option value="lime">Лайм</option>
              </select>
            </div>
          </div>
        </div>
      </div>

      <div class="settings-section">
        <div class="section-title">Календарь</div>
        <div class="settings-list">
          <div class="row item">
            <div class="left">
              <div class="label">Неделя начинается с</div>
              <div class="sub">Пн / Вс</div>
            </div>
            <div class="right">
              <select id="setWeekStart">
                <option value="1">Понедельника</option>
                <option value="0">Воскресенья</option>
              </select>
            </div>
          </div>

          <div class="row item">
            <div class="left">
              <div class="label">Кнопка «Сегодня»</div>
              <div class="sub">Быстрый прыжок к текущей дате</div>
            </div>
            <div class="right">
              <label class="switch">
                <input type="checkbox" id="setShowToday">
                <span class="slider"></span>
              </label>
            </div>
          </div>

          <div class="row item">
            <div class="left">
              <div class="label">Точки приоритетов</div>
              <div class="sub">Индикаторы в сетке</div>
            </div>
            <div class="right">
              <label class="switch">
                <input type="checkbox" id="setShowDots">
                <span class="slider"></span>
              </label>
            </div>
          </div>
        </div>
      </div>

      <div class="settings-section">
        <div class="section-title">Данные</div>
        <div class="settings-list">
          <div class="row item">
            <div class="left">
              <div class="label">Экспорт / Импорт</div>
              <div class="sub">JSON-файл с вашими задачами</div>
            </div>
            <div class="right gap">
              <button class="btn" id="btnExport">Экспорт</button>
              <label class="btn-outline">Импорт <input type="file" id="fileImport" hidden/></label>
            </div>
          </div>
        </div>
      </div>
    </section>
  </template>

  <!-- ====== MODAL ====== -->
  <dialog id="taskModal" class="modal">
    <form id="taskForm" method="dialog">
      <div class="modal-body">
        <div class="modal-head">
          <h3 id="modalTitle" class="h-impact">Новая задача</h3>
          <button data-close class="icon-btn" type="button">✖</button>
        </div>

        <div class="field">
          <label>Название</label>
          <input name="title" id="fTitle" required/>
        </div>

        <div class="grid2">
          <div class="field">
            <label>Дата</label>
            <input type="date" name="date" id="fDate"/>
          </div>
          <div class="field">
            <label>Время</label>
            <input type="time" name="time" id="fTime"/>
          </div>
        </div>

        <div class="grid2">
          <div class="field">
            <label>Важность</label>
            <select name="priority" id="fPriority">
              <option value="low">Низкая</option>
              <option value="medium">Средняя</option>
              <option value="high">Высокая</option>
              <option value="critical">Критическая</option>
            </select>
          </div>
          <div class="field">
            <label>SMART</label>
            <input name="smart" id="fSmart" placeholder="Specific/Measurable/..."/>
          </div>
        </div>

        <div class="field">
          <label>Комментарий</label>
          <textarea name="note" id="fNote" rows="2"></textarea>
        </div>

        <div class="modal-foot">
          <button data-close class="btn-outline" type="button">Отмена</button>
          <button type="submit" class="btn">Сохранить</button>
        </div>
      </div>
    </form>
  </dialog><template id="home-view">
  <div class="home">
    <div id="homeHeader">
      <button data-home-month="prev" class="navarrow">←</button>
      <h2 id="homeMonth"></h2>
      <button data-home-month="next" class="navarrow">→</button>
    </div>
    <div id="dateStrip" class="strip"></div>
    <h3 id="todayTitle">Сегодня</h3>
    <div id="taskList" class="tasklist"></div>
  </div>
</template>

<template id="calendar-view">
  <div class="calendar">
    <div class="calhead">
      <button data-cal="prev" class="navarrow">←</button>
      <h2 id="calTitle"></h2>
      <button data-cal="next" class="navarrow">→</button>
    </div>
    <div id="calendarGrid" class="grid"></div>
  </div>
</template>

<template id="stats-view">
  <div class="stats">
    <h2>Статистика</h2>
    <div class="circle">
      <svg width="120" height="120">
        <circle cx="60" cy="60" r="52" stroke="#eee" stroke-width="10" fill="none" />
        <circle id="ringFg" cx="60" cy="60" r="52" stroke="var(--accent)" stroke-width="10" fill="none"
          stroke-linecap="round" stroke-dasharray="326" stroke-dashoffset="326" />
      </svg>
      <div class="pct"><span id="statDonePct">0</span>%</div>
    </div>
    <div class="numbers">
      <p>Неделя: <span id="statWeekDone">0</span>/<span id="statWeekTotal">0</span></p>
      <p>Месяц: <span id="statMonthDone">0</span>/<span id="statMonthTotal">0</span></p>
      <p>Серия дней: <span id="statStreak">0</span></p>
    </div>
    <div id="barChart">
      <div id="bars"></div>
      <div id="barLabels"></div>
    </div>
  </div>
</template>

<template id="settings-view">
  <div class="settings">
    <h2>Настройки</h2>
    <label>Тема <select id="setTheme">
      <option value="light">Светлая</option>
      <option value="dark">Тёмная</option>
    </select></label>
    <label>Цвет акцента <select id="setAccent">
      <option value="violet">Фиолетовый</option>
      <option value="blue">Синий</option>
      <option value="pink">Розовый</option>
    </select></label>
    <label>Неделя начинается с <select id="setWeekStart">
      <option value="1">Понедельника</option>
      <option value="0">Воскресенья</option>
    </select></label>
    <label><input type="checkbox" id="setShowToday" checked> Показывать сегодняшнюю дату</label>
    <label><input type="checkbox" id="setShowDots" checked> Показывать точки задач в календаре</label>
    <hr>
    <button id="btnExport">Экспорт данных</button>
    <input type="file" id="fileImport" accept=".json">
  </div>
</template>
</body>
</html>
