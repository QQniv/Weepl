<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Weepl v4 — Сегодня</title>

  <!-- iOS PWA -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Sora:wght@500;600;700&family=Momo+Trust+Display:wght@400;700&display=swap" rel="stylesheet">

  <!-- Styles -->
  <link rel="stylesheet" href="styles.css">

  <!-- Headline + фиксированная шапка -->
  <style>
    :root{
      --heading-font: "Momo Trust Display", Sora, Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
      --safe-top: env(safe-area-inset-top);
    }
    header .title h1, .card h3{ font-family: var(--heading-font); letter-spacing:.2px; }

    header{
      position: fixed; top: 0; left: 0; right: 0; z-index: 20;
      padding: calc(20px + var(--safe-top)) var(--page-x) 10px !important;
      margin: 0 auto; max-width: var(--wrap);
      backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
      background: color-mix(in oklab, var(--panel) 88%, transparent 12%);
      border-bottom: 1px solid color-mix(in oklab, var(--ink) 8%, transparent);
      border-bottom-left-radius: 16px; border-bottom-right-radius: 16px;
    }
    header::after{
      content:""; position:absolute; left:0; right:0; bottom:-12px; height:24px; pointer-events:none;
      background: linear-gradient(180deg, color-mix(in oklab, var(--panel) 55%, transparent) 0%, transparent 100%);
      filter: blur(2px); border-bottom-left-radius: 16px; border-bottom-right-radius: 16px;
    }
    main{ padding-top: calc(var(--header-h, 96px) + 16px); }
    html.modal-open, body.modal-open{ overflow:hidden; } /* на будущее для модалок */
  </style>
</head>

<body data-theme="light">
  <!-- Фон -->
  <div class="bg"></div>
  <div class="bg-veil"></div>
  <div class="noise"></div>

  <div class="wrap">
    <!-- Шапка -->
    <header>
      <div class="title">
        <h1>Сегодня</h1>
        <div class="date" id="todayDate">Вторник, 4 ноября</div>
      </div>
      <div class="controls">
        <button class="icon-btn" id="themeToggle" aria-label="Переключить тему">
          <svg id="sunIcon" viewBox="0 0 24 24" fill="none" stroke-width="1.8">
            <circle cx="12" cy="12" r="4"></circle>
            <path d="M12 2v2M12 20v2M4 12H2M22 12h-2M5 5l-1.5-1.5M19 19l1.5 1.5M19 5l1.5-1.5M5 19L3.5 20.5"></path>
          </svg>
          <svg id="moonIcon" viewBox="0 0 24 24" fill="none" stroke-width="1.8" style="display:none">
            <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
          </svg>
        </button>
      </div>
    </header>

    <main>
      <!-- AI-совет (архитектура под реальный AI) -->
      <section class="ai" data-ai-root>
        <div class="ai-tip" id="aiTip" title="Обновить совет" data-ai-card>
          <span class="ai-dot"></span>
          <span id="aiText" data-ai-text>AI-совет загружается…</span>
          <span class="ai-refresh" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" stroke-width="2"><path d="M20 11a8 8 0 1 1-2.34-5.66M20 4v7h-7"></path></svg>
          </span>
        </div>
      </section>

      <!-- Сетка задач (перетаскивание между A/B/C/D добавим в app.js) -->
      <section class="grid" aria-labelledby="gridTitle" data-matrix-root>
        <h2 id="gridTitle" class="sr-only">Задачи на сегодня</h2>
        <div class="grid-inner" aria-label="Задачи на сегодня">
          <article class="card wide" tabindex="0">
            <div><h3>Разработка интерфейса</h3><p>UI прототип Weepl v4 — главная и матрица</p></div>
            <div class="meta"><span>Проект: Weepl</span><span>09:00</span></div>
          </article>

          <article class="card square" tabindex="0">
            <div><h3>Кофе и планирование</h3><p>10 минут тишины, ревью задач</p></div>
            <div class="meta"><span>Фокус</span><span>11:00</span></div>
          </article>

          <article class="card tall" tabindex="0">
            <div><h3>Митинг с Артёмом</h3><p>Микроанимации, матрица Эйзенхауэра</p></div>
            <div class="meta"><span>Созвон</span><span>13:30</span></div>
          </article>

          <article class="card square" tabindex="0">
            <div><h3>Прогулка / перезагрузка</h3><p>Короткий спринт восстановления</p></div>
            <div class="meta"><span>Здоровье</span><span>15:10</span></div>
          </article>

          <article class="card wide" tabindex="0">
            <div><h3>Архив → разбор</h3><p>Что отдать в «завтра», а что закрыть сегодня</p></div>
            <div class="meta"><span>Подведение итогов</span><span>17:00</span></div>
          </article>
        </div>
      </section>

      <!-- Привычки (виджет-превью + отдельная вкладка позже) -->
      <section class="habits" data-habits-root>
        <div class="habits-head">
          <h2 style="font-family:var(--heading-font);font-size:22px">Привычки</h2>
          <button class="link-btn" id="openHabits">Все</button>
        </div>
        <div class="habits-row" aria-label="Привычки дня">
          <button class="habit chip" data-habit="water" aria-pressed="false">Вода 2л</button>
          <button class="habit chip" data-habit="walk" aria-pressed="false">Прогулка 20 мин</button>
          <button class="habit chip" data-habit="reading" aria-pressed="false">Чтение 15 мин</button>
          <button class="habit chip" data-habit="phone" aria-pressed="false">Без телефона утром</button>
        </div>
      </section>
    </main>
  </div>

  <!-- Нижняя навигация -->
  <nav>
    <div class="dock wrap" role="tablist" aria-label="Основная навигация">
      <button class="active" role="tab" aria-selected="true">
        <svg viewBox="0 0 24 24" fill="none" stroke-width="2"><path d="M3 10.5l9-7 9 7V21a1 1 0 0 1-1 1h-5v-6H9v6H4a1 1 0 0 1-1-1V10.5z"/></svg>
        Сегодня
      </button>
      <button role="tab">
        <svg viewBox="0 0 24 24" fill="none" stroke-width="2"><rect x="3" y="4" width="18" height="16" rx="2"/><path d="M7 8h10M7 12h6M7 16h5"/></svg>
        Архив
      </button>
      <button role="tab">
        <svg viewBox="0 0 24 24" fill="none" stroke-width="2"><path d="M3 17s3-6 9-6 9 6 9 6"/><circle cx="12" cy="11" r="2"/></svg>
        Аналитика
      </button>
      <button role="tab">
        <svg viewBox="0 0 24 24" fill="none" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 1 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 5 15.4a1.65 1.65 0 0 0-1.51-1H3a2 2 0 1 1 0-4h.09a1.65 1.65 0 0 0 1.51-1 1.65 1.65 0 0 0-.33-1.82l-.06-.06A2 2 0 1 1 7.04 3.7l.06.06A1.65 1.65 0 0 0 8.6 4.1"/></svg>
        Настройки
      </button>
    </div>
  </nav>

  <!-- Мини-скрипт: тема, дата, высота шапки (всё остальное — в app.js) -->
  <script>
    const body = document.body, toggle = document.getElementById('themeToggle');
    const sun = document.getElementById('sunIcon'), moon = document.getElementById('moonIcon');
    function setTheme(t){ body.dataset.theme=t; const d=t==='dark'; sun.style.display=d?'none':'block'; moon.style.display=d?'block':'none'; localStorage.setItem('weepl-theme',t);}
    setTheme(localStorage.getItem('weepl-theme') || 'light');
    toggle.addEventListener('click', ()=> setTheme(body.dataset.theme==='light'?'dark':'light'));

    function updateHeaderOffset(){
      const h = document.querySelector('header').getBoundingClientRect().height;
      document.documentElement.style.setProperty('--header-h', h + 'px');
    }
    window.addEventListener('load', updateHeaderOffset, {once:true});
    window.addEventListener('resize', updateHeaderOffset);
    window.addEventListener('orientationchange', ()=> setTimeout(updateHeaderOffset, 250));

    // Локализация даты
    const opts = {weekday:'long', day:'numeric', month:'long'};
    const d = new Date(); document.getElementById('todayDate').textContent =
      new Intl.DateTimeFormat('ru-RU', opts).format(d).replace(/^\w/u, c=>c.toUpperCase());
  </script>

  <!-- Логика (после стилей подключим полноценный app.js) -->
  <script src="app.js" defer></script>
</body>
</html>
