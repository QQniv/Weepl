<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Weepl • Планировщик</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <!-- Заголовки: Impact / Anton; текст: Inter как гармоничный компаньон -->
  <link href="https://fonts.googleapis.com/css2?family=Anton&family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
</head>
<body class="theme-light">
  <!-- Вью: Задачи (главная) -->
  <header id="topbar" class="topbar">
    <h1 id="monthTitle" class="month-title">Октябрь 2025 г.</h1>
    <div class="month-nav">
      <button id="mPrev" class="icon-btn" aria-label="Предыдущий месяц">←</button>
      <button id="mNext" class="icon-btn" aria-label="Следующий месяц">→</button>
    </div>
  </header>

  <main id="viewContainer">
    <!-- VIEW: TODAY -------------------------------------------------------->
    <section id="view-today" class="view is-active" aria-label="Главный экран">
      <!-- Барабан дат ТОЛЬКО здесь -->
      <div id="dateScroller" class="date-scroller" role="tablist" aria-label="Дни недели"></div>

      <!-- Таймлайн (события блоками по времени) -->
      <section class="timeline-wrap">
        <div id="timeline" class="timeline" aria-label="Временная шкала 06–20"></div>
      </section>

      <!-- Список задач (скролл внутри) -->
      <section class="tasklist-wrap">
        <header class="section-head">
          <h2>Задачи</h2>
          <div id="tasksKpi" class="kpi"></div>
        </header>
        <ul id="taskList" class="task-list" aria-live="polite"></ul>
      </section>
    </section>

    <!-- VIEW: CALENDAR ----------------------------------------------------->
    <section id="view-calendar" class="view" aria-label="Календарь">
      <!-- В календаре НЕТ барабана дат; только крупная сетка месяца -->
      <header class="cal-head">
        <button id="calPrev" class="icon-btn" aria-label="Предыдущий месяц">←</button>
        <h2 id="calTitle" class="month-title">Октябрь 2025 г.</h2>
        <button id="calNext" class="icon-btn" aria-label="Следующий месяц">→</button>
      </header>

      <div class="cal-weekdays">
        <span>Пн</span><span>Вт</span><span>Ср</span><span>Чт</span><span>Пт</span><span>Сб</span><span>Вс</span>
      </div>

      <!-- сетка, целиком помещается в экран, отдельная прокрутка при малой высоте -->
      <div id="calendarWrap" class="calendar-wrap">
        <div id="calendarGrid" class="calendar-grid" role="grid" aria-label="Сетка месяца"></div>
      </div>
    </section>

    <!-- VIEW: STATS -------------------------------------------------------->
    <section id="view-stats" class="view" aria-label="Статистика">
      <h2 class="screen-title">Статистика</h2>
      <div class="stats-grid">
        <div class="card">
          <div class="ring" aria-hidden="true">
            <svg viewBox="0 0 120 120">
              <circle cx="60" cy="60" r="52" class="ring-bg"></circle>
              <circle cx="60" cy="60" r="52" class="ring-fg" id="ringFg"></circle>
            </svg>
            <div class="ring-center">
              <span id="ringPct" class="ring-pct">0%</span>
            </div>
          </div>
          <div class="card-caption">Выполнено за неделю</div>
        </div>
        <div class="card kpi-card">
          <div class="kpi-big"><span id="kpi7Done">0</span> / <span id="kpi7Total">0</span></div>
          <div class="card-caption">За 7 дней</div>
        </div>
        <div class="card kpi-card">
          <div class="kpi-big"><span id="kpi30Done">0</span> / <span id="kpi30Total">0</span></div>
          <div class="card-caption">За месяц</div>
        </div>
        <div class="card kpi-card">
          <div class="kpi-big"><span id="streakVal">0</span> дн.</div>
          <div class="card-caption">Серия выполнения</div>
        </div>
        <div class="card card-wide">
          <header class="card-row">
            <h3>Выполнено по дням</h3>
            <span class="muted">последние 7 дней</span>
          </header>
          <div id="bar7" class="bars-7"></div>
        </div>
      </div>
    </section>

    <!-- VIEW: SETTINGS ----------------------------------------------------->
    <section id="view-settings" class="view" aria-label="Настройки">
      <h2 class="screen-title">Настройки</h2>

      <div class="prefs">
        <div class="pref-row">
          <div class="pref-title">Тема</div>
          <div class="pref-control">
            <label class="switch">
              <input id="themeToggle" type="checkbox" />
              <span class="slider"></span>
            </label>
            <span id="themeLabel" class="muted">Светлая</span>
          </div>
        </div>

        <div class="pref-row">
          <div class="pref-title">Акцент</div>
          <div class="pref-control">
            <input id="accentPicker" type="color" value="#5b5bf0" />
            <button id="accentPreset" class="btn ghost">Палитра</button>
          </div>
        </div>

        <div class="pref-row">
          <div class="pref-title">Размер текста</div>
          <div class="pref-control">
            <input id="fontScale" type="range" min="90" max="115" step="5" value="100" />
            <span id="fontScaleVal" class="muted">100%</span>
          </div>
        </div>

        <div class="pref-row">
          <div class="pref-title">Стиль акцентов</div>
          <div class="pref-control">
            <label><input type="checkbox" id="fxNeon" /> неоновое свечение</label>
            <label><input type="checkbox" id="fxMetal" /> «металличность»</label>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- FAB -->
  <button id="fab" class="fab" aria-label="Добавить">+</button>

  <!-- Bottom Nav -->
  <nav class="tabbar" aria-label="Навигация">
    <button class="tab is-active" data-view="view-today" aria-label="Список">
      <span class="i i-list"></span>
    </button>
    <button class="tab" data-view="view-calendar" aria-label="Календарь">
      <span class="i i-cal"></span>
    </button>
    <button class="tab" data-view="view-stats" aria-label="Статистика">
      <span class="i i-stats"></span>
    </button>
    <button class="tab" data-view="view-settings" aria-label="Настройки">
      <span class="i i-gear"></span>
    </button>
  </nav>

  <!-- MODAL: Add item -->
  <dialog id="dlgAdd" class="modal">
    <form method="dialog" class="modal-card" id="addForm">
      <header class="modal-head">
        <h3>Новое</h3>
      </header>

      <div class="field-row">
        <label class="seg">
          <input type="radio" name="kind" value="task" checked />
          <span>Задача</span>
        </label>
        <label class="seg">
          <input type="radio" name="kind" value="event" />
          <span>Событие</span>
        </label>
      </div>

      <label class="field">
        <span>Название</span>
        <input name="title" required placeholder="Что сделать?" />
      </label>

      <div class="grid-2">
        <label class="field">
          <span>Дата</span>
          <input type="date" name="date" required />
        </label>
        <label class="field">
          <span>Время</span>
          <input type="time" name="time" value="08:00" />
        </label>
      </div>

      <div class="grid-2 when-event">
        <label class="field">
          <span>Длительность (мин)</span>
          <input type="number" name="duration" min="15" step="15" value="60" />
        </label>
        <label class="field">
          <span>Приоритет</span>
          <select name="priority">
            <option value="low">низкий</option>
            <option value="medium" selected>средний</option>
            <option value="high">высокий</option>
          </select>
        </label>
      </div>

      <label class="field">
        <span>Комментарий</span>
        <textarea name="note" rows="2" placeholder="Опционально"></textarea>
      </label>

      <footer class="modal-foot">
        <button value="cancel" class="btn ghost">Отмена</button>
        <button type="submit" class="btn primary">Сохранить</button>
      </footer>
    </form>
  </dialog>

  <!-- MODAL: Reschedule -->
  <dialog id="dlgMove" class="modal">
    <form method="dialog" class="modal-card" id="moveForm">
      <header class="modal-head"><h3>Перенос</h3></header>
      <div class="grid-2">
        <label class="field">
          <span>Новая дата</span>
          <input type="date" name="mdate" required />
        </label>
        <label class="field">
          <span>Время</span>
          <input type="time" name="mtime" value="08:00" />
        </label>
      </div>
      <footer class="modal-foot">
        <button value="cancel" class="btn ghost">Отмена</button>
        <button type="submit" class="btn primary">Перенести</button>
      </footer>
    </form>
  </dialog>

  <script src="app.js"></script>
</body>
</html>
