/* =======================================
   THEME TOKENS
======================================= */
:root{
  --accent:#5b5bf0;
  --accent-2:#7c7cff;
  --bg:#f5f6fb;
  --bg-soft:#eef1f8;
  --card:#ffffff;
  --ink:#0c0d12;
  --muted:#667085;
  --ring:#e5e7f0;
  --ok:#16a34a;
  --warn:#f59e0b;
  --danger:#ef4444;

  --radius:16px;
  --shadow:0 6px 24px rgba(20,20,40,.08);
  --shadow-2:0 16px 40px rgba(20,20,40,.12);

  --fontScale:1;
  --neon:0;            /* 0..1 */
  --metallic:0;        /* 0..1 */
}

/* динамические эффекты акцента */
:root{
  --accentGlow: drop-shadow(0 0 calc(18px*var(--neon)) var(--accent));
  --accentSheen: linear-gradient(135deg,
    rgba(255,255,255,calc(.35*var(--metallic))) 0%,
    rgba(255,255,255,0) 40%);
}

/* =======================================
   RESET & BASE
======================================= */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;background:var(--bg);color:var(--ink);
  font:calc(16px*var(--fontScale)) Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
  -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
}
img,svg{display:block;max-width:100%}
button{font:inherit;color:inherit}
h1,h2,h3,p{margin:0}

/* утилити */
.hide{display:none !important}
.muted{color:var(--muted)}
.center{display:grid;place-items:center}
.row{display:flex;align-items:center;gap:10px}
.stack{display:flex;flex-direction:column;gap:10px}
.shadow{box-shadow:var(--shadow)}
.round{border-radius:var(--radius)}
hr{border:0;border-top:1px solid var(--ring);margin:10px 0}

/* =======================================
   LAYOUT
======================================= */
.container{max-width:980px;margin:0 auto;padding:0 16px}
.view{display:none;min-height:calc(100dvh - 90px)}
.view.is-active{display:block}

/* =======================================
   TOPBAR
======================================= */
.topbar{
  position:sticky;top:env(safe-area-inset-top,0);
  z-index:5;background:var(--bg);
  padding:10px 16px 0;
}
.topbar h1{
  margin:6px 0 10px;
  font:800 28px/1 Impact, Inter, system-ui;
  letter-spacing:.5px;
}

/* =======================================
   DATE SCROLLER (Today view)
======================================= */
.date-scroller{
  display:flex;gap:12px;overflow:auto;padding:8px 0 12px;
  scrollbar-width:none;scroll-snap-type:x mandatory;
}
.date-scroller::-webkit-scrollbar{display:none}
.date-pill{
  scroll-snap-align:center;
  min-width:92px;border:0;background:var(--card);
  border-radius:20px;padding:10px 12px;
  box-shadow:var(--shadow);
  cursor:pointer;transition:.2s transform, .2s background, .2s color;
  position:relative;overflow:hidden;
}
.date-pill:before{
  content:"";position:absolute;inset:0;pointer-events:none;
  background:var(--accentSheen);opacity:var(--metallic);
}
.date-pill .dow{color:var(--muted);font-weight:700;letter-spacing:.04em}
.date-pill .day{font:800 26px/1 Impact}
.date-pill .mon{color:var(--muted)}
.date-pill:hover{transform:translateY(-1px)}
.date-pill.is-active{
  background:var(--accent);color:#fff;transform:translateY(-1px);
  filter:var(--accentGlow);
}
.date-pill.is-active .mon{color:#eef}

/* =======================================
   TIMELINE (events)
======================================= */
.timeline-wrap{
  position:relative;margin:8px 0;border-radius:18px;
  background:var(--card);box-shadow:var(--shadow);padding:12px;
  overflow:hidden;
}
.timeline{position:relative;min-height:520px}
.timeline:before{
  content:"";position:absolute;left:60px;top:0;bottom:0;width:2px;background:var(--ring);
}
.time-row{
  position:relative;height:60px;border-bottom:1px dashed var(--ring);
}
.time-label{
  position:absolute;left:0;top:50%;transform:translate(-8px,-50%);
  color:var(--muted);font-weight:600;font-size:.9em;
}

/* событие-блок */
.event{
  position:absolute;left:76px;right:10px;
  border-radius:14px;padding:10px 12px;
  color:#fff;background:var(--accent);
  box-shadow:0 12px 28px rgba(91,91,240,.25);
  overflow:hidden;display:flex;align-items:center;gap:10px;
}
.event .dot{width:10px;height:10px;border-radius:99px;background:#fff;opacity:.8}
.event .title{font-weight:800}
.event .meta{font-size:.9em;opacity:.8}

/* =======================================
   TASK LIST
======================================= */
.tasklist-wrap{margin:14px 0 120px}
.section-head{display:flex;align-items:baseline;gap:12px;padding:0 2px}
.section-head h2{font:800 22px/1.2 Inter}
#kpiCounter{color:var(--muted)}
.task-list{list-style:none;margin:10px 0 0;padding:0;display:flex;flex-direction:column;gap:10px}
.task-row{
  background:var(--card);border-radius:18px;box-shadow:var(--shadow);
  padding:12px 56px 12px 14px;position:relative;transition:.15s;
  display:grid;grid-template-columns:1fr auto;gap:10px;
}
.task-row .title{font-weight:800}
.task-row .meta{font-size:.9em;color:var(--muted)}
.task-row.task-done{opacity:.55;text-decoration:line-through}
.task-row.swiping-right{transform:translateX(60px)}
.task-row.swiping-left{transform:translateX(-60px)}

.task-actions{
  position:absolute;right:10px;top:50%;transform:translateY(-50%);
  display:flex;gap:8px
}
.icon-small{
  border:0;background:#f0f3ff;border-radius:12px;padding:6px 8px;cursor:pointer;
  transition:.15s;display:inline-grid;place-items:center;
}
.icon-small:hover{background:#e8ebff}
.icon-ok{background:#e6f8ed}.icon-ok:hover{background:#dff5e7}
.icon-del{background:#ffeaea}.icon-del:hover{background:#ffe2e2}

/* свайп-подложки */
.swipe-bg{
  position:absolute;inset:0;border-radius:inherit;z-index:-1;
  display:flex;align-items:center;justify-content:space-between;padding:0 12px;
  color:#fff;opacity:0;transition:.15s;
}
.task-row.swiping-right + .swipe-bg{background:var(--ok);opacity:.2}
.task-row.swiping-left + .swipe-bg{background:var(--danger);opacity:.2}

/* =======================================
   CALENDAR VIEW
======================================= */
.cal-head{display:flex;justify-content:space-between;align-items:center;padding:10px 2px}
.month-title{font:800 24px/1 Impact}
.icon-btn{border:0;background:var(--card);border-radius:12px;padding:8px 10px;box-shadow:var(--shadow);cursor:pointer}

.cal-weekdays{display:grid;grid-template-columns:repeat(7,1fr);gap:10px;padding:0 2px;color:var(--muted);font-weight:700}
.calendar-wrap{padding-bottom:110px}
.calendar-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:10px}
.cal-cell{
  border:0;background:var(--card);border-radius:16px;padding:18px 10px;box-shadow:var(--shadow);cursor:pointer;
  min-height:70px;display:grid;place-items:center;font-weight:800
}
.cal-cell.is-out{opacity:.35}
.cal-cell.is-today{outline:2px solid var(--accent)}
.cal-cell.is-selected{background:var(--accent);color:#fff;filter:var(--accentGlow)}
.cal-events{margin-top:6px;display:flex;gap:4px;flex-wrap:wrap;justify-content:center}
.cal-dot{width:6px;height:6px;border-radius:99px;background:var(--accent)}

/* =======================================
   STATS
======================================= */
.stats-grid{
  display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px;margin-top:12px
}
.card{background:var(--card);border-radius:16px;box-shadow:var(--shadow);padding:14px}
.card-caption{margin-top:6px;color:var(--muted);font-size:.9em;text-align:center}

.ring{position:relative;width:140px;height:140px;margin:0 auto}
.ring svg{width:140px;height:140px}
.ring-bg{fill:none;stroke:var(--ring);stroke-width:12}
.ring-fg{fill:none;stroke:var(--accent);stroke-width:12;stroke-linecap:round;stroke-dasharray:400;stroke-dashoffset:400;transition:stroke-dashoffset .6s cubic-bezier(.4,0,.2,1)}
.ring-center{position:absolute;inset:0;display:grid;place-items:center}
.ring-pct{font:800 24px/1 Impact}

/* =======================================
   SETTINGS
======================================= */
.settings{display:grid;gap:12px;margin:10px 0 120px}
.field{display:flex;justify-content:space-between;align-items:center;margin:10px 0}
.field-row{display:flex;align-items:center;gap:12px;margin:8px 0}

.color-chip{
  width:24px;height:24px;border-radius:50%;border:2px solid #fff;box-shadow:var(--shadow);
}
.switch{appearance:none;width:46px;height:26px;border-radius:30px;background:#e7e9f2;position:relative;outline:none;cursor:pointer;transition:.15s}
.switch:checked{background:var(--accent)}
.switch:before{content:"";position:absolute;top:3px;left:3px;width:20px;height:20px;border-radius:99px;background:#fff;transition:.15s}
.switch:checked:before{left:23px}

.range{accent-color:var(--accent)}

/* =======================================
   TABBAR & FAB
======================================= */
.tabbar{
  position:fixed;left:0;right:0;bottom:0;background:rgba(255,255,255,.75);
  backdrop-filter:saturate(160%) blur(16px);
  display:flex;justify-content:space-around;align-items:center;height:70px;padding:8px 10px;z-index:10;
  border-top:1px solid var(--ring)
}
.tab{border:0;background:transparent;padding:8px 14px;border-radius:14px;display:grid;place-items:center}
.tab.is-active{background:rgba(91,91,240,.1);color:var(--accent)}
.fab{
  position:fixed;left:50%;transform:translateX(-50%);bottom:22px;z-index:11;
  border:0;width:64px;height:64px;border-radius:50%;font:900 28px/1 Inter;background:var(--accent);color:#fff;
  box-shadow:0 18px 36px rgba(91,91,240,.35);filter:var(--accentGlow);
}

/* иконки-заглушки */
.i{display:inline-block;width:22px;height:22px;border-radius:6px;background:linear-gradient(180deg,#aab1c7,#6c748f)}
.i-cal{background:linear-gradient(180deg,#ccd2e7,#7d86a7)}
.i-bars{background:linear-gradient(180deg,#cfe2ff,#6a8ff0)}
.i-gear{background:linear-gradient(180deg,#d8dee9,#7a879e)}
.i-list{background:linear-gradient(180deg,#dfe4ef,#8d96ad)}

/* =======================================
   DIALOGS / MODALS / TOASTS
======================================= */
.modal::backdrop{background:rgba(0,0,20,.4)}
.modal{border:0;padding:0;background:transparent}
.modal-card{background:var(--card);border-radius:18px;box-shadow:var(--shadow-2);padding:14px;min-width:300px}

.btn{border:0;border-radius:12px;padding:10px 14px;font-weight:700;cursor:pointer}
.btn-accent{background:var(--accent);color:#fff;filter:var(--accentGlow)}
.btn-ghost{background:#eef1ff}
.btn-danger{background:var(--danger);color:#fff}

.toast{
  position:fixed;left:50%;bottom:92px;transform:translateX(-50%);
  background:#111;color:#fff;padding:10px 14px;border-radius:12px;opacity:0;pointer-events:none;
}
.toast.show{animation:toast 2.2s ease both}
@keyframes toast{0%{opacity:0;transform:translate(-50%,10px)}20%,80%{opacity:1;transform:translate(-50%,0)}100%{opacity:0;transform:translate(-50%,-6px)}}

/* =======================================
   ANIMATIONS
======================================= */
.fade-in{animation:fade .18s ease both}
@keyframes fade{from{opacity:0;transform:translateY(4px)}to{opacity:1;transform:none}}
.pop{animation:pop .18s ease both}
@keyframes pop{from{transform:scale(.98)}to{transform:scale(1)}}

/* =======================================
   DARK THEME
======================================= */
@media (prefers-color-scheme: dark){
  :root{
    --bg:#0f1116; --bg-soft:#151925; --card:#0f1422;
    --ink:#eef2ff; --muted:#b6bdd3; --ring:#1d2436;
    --shadow:0 10px 30px rgba(0,0,0,.35);
    --shadow-2:0 18px 50px rgba(0,0,0,.5);
  }
  .tabbar{background:rgba(10,12,18,.6);border-top-color:#1d2436}
  .icon-small{background:#1b2236}.icon-small:hover{background:#1f2942}
}

/* =======================================
   RESPONSIVE
======================================= */
@media (min-width:740px){
  .timeline{min-height:640px}
  .stats-grid{grid-template-columns:repeat(4,minmax(0,1fr))}
}

/* =======================================
   THEME CUSTOMIZER (runtime variables)
   — управляется JS:
   document.documentElement.style.setProperty('--accent', value)
   document.documentElement.style.setProperty('--fontScale', value)
   document.documentElement.style.setProperty('--neon', value)
   document.documentElement.style.setProperty('--metallic', value)
======================================= */
